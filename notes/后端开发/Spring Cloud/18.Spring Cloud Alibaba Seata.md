---
typora-copy-images-to: images
---

# 1、分布式事务问题

分布式前：单机单库没有问题

分布式后：

![1589272744185](images/1589272744185.png)

# 2、Seata简介

![1589272827760](images/1589272827760.png)

官网：http://seata.io/zh-cn/

![1589273121258](images/1589273121258.png)

![1589273082574](images/1589273082574.png)

![1589273031167](images/1589273031167.png)

![1589273248725](images/1589273248725.png)

***





# 3、怎么玩?

![1589273738078](images/1589273738078.png)



![1589273698803](images/1589273698803.png)

# 4、下载安装

**`mysql8的话：`**

![1589274678893](images/1589274678893.png)

![1589274686665](images/1589274686665.png)

- 下载和安装:

https://github.com/seata/seata/releases

0.9版本 1.0均可

- seata-server-0.9.0.zip解压到指定目录并修改conf目录下的file.conf配置文件

  ![1589273894308](images/1589273894308.png)

![1589273873263](images/1589273873263.png)

`修改file.conf里的`service模块`和`store模块(sotre:存储模块)

==service模块:==

![1589274037209](images/1589274037209.png)

==store模块：==

![1589274146174](images/1589274146174.png)

![1589274173205](images/1589274173205.png)



- mysql5.7数据库新建库 seata



- 在seata库里建表

`建表文件在`

![1589274234915](images/1589274234915.png)

- 修改 seata-server-0.9.0\seata\conf目录下的registry.conf配置文件

![1589274309323](images/1589274309323.png)

- 先启动Nacos端口号8848



- 再启动 seata-server



# 5、订单/库存/账户业务数据库准备

### 5.1 以下演示都需要`先启动Nacos后启动Seata`，保证两个都OK



### 5.2 分布式事务业务说明

![1589274881764](images/1589274881764.png)

![1589274939838](images/1589274939838.png)

### 5.3 创建业务数据库

![1589274953523](images/1589274953523.png)

### 5.4 按照上述3库 分别建对应业务表

![1589275017660](images/1589275017660.png)

![1589275031037](images/1589275031037.png)

![1589275068588](images/1589275068588.png)

![1589275198284](images/1589275198284.png)

### 5.5 按照上述3库分别建对应的回滚日志表

![1589275122768](images/1589275122768.png)



### 5.6 最后效果

![1589275172374](images/1589275172374.png)

# 6、订单/库存/账户业务微服务准备

业务需求：

![1589275284579](images/1589275284579.png)

### 6.1 新建订单 Order-Module

#### 6.1.1 seata-order-service2001



#### 6.1.2 POM

![1589275635339](images/1589275635339.png)

#### 6.1.3 YML

![1589275673061](images/1589275673061.png)

![1589275702075](images/1589275702075.png)

#### 6.1.4 file.conf

![1589275772771](images/1589275772771.png)

#### 6.1.5 registry.conf

![1589275825980](images/1589275825980.png)

#### 6.1.6 domain

![1589275859689](images/1589275859689.png)

- CommonResult

![1589275566927](images/1589275566927.png)

- Order

![1589275579712](images/1589275579712.png)

#### 6.1.7 Dao接口及实现

![1589293124599](images/1589293124599.png)

![1589293505056](images/1589293505056.png)

![1589293564233](images/1589293564233.png)

#### 6.1.8 Service接口及实现

`OrderService`

![1589293584789](images/1589293584789.png)

`OrderServiceImpl`(记得加上service注解)

![1589294318505](images/1589294318505.png)

![1589294334229](images/1589294334229.png)



`StorageService`(库存)

![1589293881311](images/1589293881311.png)

`AccountService`

![1589294045577](images/1589294045577.png)

#### 6.1.9 Controller

`OrderController`

![1589294520937](images/1589294520937.png)



#### 6.1.10 Config配置

![1589294563026](images/1589294563026.png)

![1589294577466](images/1589294577466.png)

#### 6.1.11 主启动

![1589294600756](images/1589294600756.png)

### 6.2 新建库存 Storage-Module



### 6.3 新建账户 Account-Module