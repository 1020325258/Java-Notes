[TOC]



# 使用正则表达式替换文本中的html标签

我们存储 markdown 文章时，如果存储转换后的 html 页面，那么在查出来的时候，会带有标签，可以使用正则表达式去除标签



## 原文本：

```
<p>大佬们，今天面试的时候有个面试官问我如何保证支付接口的幂等、防重复扣费、防并发。</p><p>我想的是：</p><ol><li><p>接口进来的时候要先获取钱包表的版本号用于去更新钱包表（防并发）</p></li><li><p>每次扣费完成后，扣费完成后，插入redis里一个标志，key 要包含订单号，代表着这个订单已经支付过了，接口入口的地方要先在redis里查一下有没有这个key，有的话，就直接返回支付成功，没有的话就往下进行去扣费，key存活时间24小时。（做幂等）</p></li><li><p>扣费后，往扣费记录表插入一个扣费记录，用订单id做唯一索引，并且要catch住唯一约束异常并加报警。防止重复扣费</p><p>插入redis要和插入扣费记录以及钱包表扣费在同一个事务中</p></li></ol><p>面试官听完没说什么，大佬们觉得这样做可以么？有什么不妥的地方么？</p>
```



## 使用正则表达式进行替换

```javascript
article = article.replace(/<\/?.+?\/?>|\r|\n|\s*/g,'')
```



## 替换后：

```
大佬们，今天面试的时候有个面试官问我如何保证支付接口的幂等、防重复扣费、防并发。我想的是：接口进来的时候要先获取钱包表的版本号用于去更新钱包表（防并发）每次扣费完成后，扣费完成后，插入redis里一个标志，key要包含订单号，代表着这个订单已经支付过了，接口入口的地方要先在redis里查一下有没有这个key，有的话，就直接返回支付成功，没有的话就往下进行去扣费，key存活时间24小时。（做幂等）扣费后，往扣费记录表插入一个扣费记录，用订单id做唯一索引，并且要catch住唯一约束异常并加报警。防止重复扣费插入redis要和插入扣费记录以及钱包表扣费在同一个事务中面试官听完没说什么，大佬们觉得这样做可以么？有什么不妥的地方么？
```



## 展示 html 文本

如果要展示 html 文本，肯定不能直接删除掉标签，如下即可：

```html
<div class="content" v-html="detail.content"></div>
```

